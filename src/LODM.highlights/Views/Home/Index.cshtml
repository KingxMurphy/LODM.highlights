@using Microsoft.EntityFrameworkCore.Metadata.Internal
@{
    ViewData["Title"] = "Overwatch";
}
<div>
    @*<div id="myCarousel" class="carousel slide" data-ride="carousel" data-interval="6000">
        <ol class="carousel-indicators">
            <li data-target="#myCarousel" data-slide-to="0" class="active"></li>
            <li data-target="#myCarousel" data-slide-to="1"></li>
            <li data-target="#myCarousel" data-slide-to="2"></li>
            <li data-target="#myCarousel" data-slide-to="3"></li>
        </ol>
        <div class="carousel-inner" role="listbox">
            <div class="item active">
                <img src="~/images/banner1.svg" alt="ASP.NET" class="img-responsive" />
                <div class="carousel-caption" role="option">
                    <p>
                        Learn how to build ASP.NET apps that can run anywhere.
                        <a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkID=525028&clcid=0x409">
                            Learn More
                        </a>
                    </p>
                </div>
            </div>
            <div class="item">
                <img src="~/images/banner2.svg" alt="Visual Studio" class="img-responsive" />
                <div class="carousel-caption" role="option">
                    <p>
                        There are powerful new features in Visual Studio for building modern web apps.
                        <a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkID=525030&clcid=0x409">
                            Learn More
                        </a>
                    </p>
                </div>
            </div>
            <div class="item">
                <img src="~/images/banner3.svg" alt="Package Management" class="img-responsive" />
                <div class="carousel-caption" role="option">
                    <p>
                        Bring in libraries from NuGet, Bower, and npm, and automate tasks using Grunt or Gulp.
                        <a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkID=525029&clcid=0x409">
                            Learn More
                        </a>
                    </p>
                </div>
            </div>
            <div class="item">
                <img src="~/images/banner4.svg" alt="Microsoft Azure" class="img-responsive" />
                <div class="carousel-caption" role="option">
                    <p>
                        Learn how Microsoft's Azure cloud platform allows you to build, deploy, and scale web apps.
                        <a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkID=525027&clcid=0x409">
                            Learn More
                        </a>
                    </p>
                </div>
            </div>
        </div>
        <a class="left carousel-control" href="#myCarousel" role="button" data-slide="prev">
            <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
            <span class="sr-only">Previous</span>
        </a>
        <a class="right carousel-control" href="#myCarousel" role="button" data-slide="next">
            <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
            <span class="sr-only">Next</span>
        </a>
    </div>*@

</div>

@foreach (var gamer in Model.MembersList)
{
    <div class="jumbotron">
        <h3>@gamer.GamerTag</h3>
        <div class="row">
            @foreach (var highlight in Model.ReturnHighlightsByGamerTag(gamer.GamerTag))
            {
                <div class="col-sm-6 col-md-4">
                    <div class="thumbnail youtube-show bottom-buffer center-block">
                        <button id="showVideobtn" type="button" class="btn btn-primary btn-lg" data-target="#embedHighlightModal" data-gamerTag="@gamer.GamerTag" data-embedUrl="@highlight.EmbedUrl">Launch My Damn Modal</button>
                        <a href="#" id="videoLink" title="Watch this highlight" >@*href="@highlight.Url"*@
                            <div>
                                <img class="img-responsive center-block" src="@highlight.ThumbnailUrl" alt="Thumbnail of highlight"/>
                            </div>
                        </a>
                        <div class="caption text-center">
                            <h3>
                                <a href="#" data-toggle="modal" title="Watch this highlight" data-target="#embedHighlightModal"
                                   data-gamerTag="@gamer.GamerTag" data-embedUrl="@highlight.Url">
                                    @if (highlight.HasTitle)
                                    {
                                        @highlight.Title<br/>
                                    }
                                </a>
                                <span class="show-date">@highlight.HighlightDate.DateTime.ToString("MMM dd, yyyy")</span>
                                @if (highlight.IsNew)
                                {
                                    <span class="label label-success label-new-show">New</span>
                                }
                            </h3>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
}
@*<div>
    <partial name="_EmbedHighlightPartial" model="Model"></partial>
</div>*@
@section scripts{
<div class="modal fade" tabindex="-1" role="dialog" id="embedHighlightModal" aria-labelledby="embedHighlightModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="embedHighlightModalLabel">Modal title</h4>
            </div>
            <div class="modal-body">
                <iframe width="100%" height="350" src=""></iframe>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                @*<button type="button" class="btn btn-primary">Save changes</button>*@
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

    <script>
        $('#showVideobtn').click(function () {
            var gamerTag = $(this).data("gamertag");
            var urlSrc = $(this).data("embedurl");
            var modal = $(this).data('target');
            // take from the button on data tags and stick them into the modal 
            $(modal + ' iframe').attr('src', urlSrc);
            $(modal).find('.modal-title').text("Gamertag: " + gamerTag);
            $('#embedHighlightModal').modal('toggle');
        });
        //This is a bootstrap call. When the modal goes away, we remove the src so that the video will stop playing.
        $('#embedHighlightModal').on('hidden.bs.modal', function() {
            $('#embedHighlightModal iframe').removeAttr('src');
        });
    </script>

}

